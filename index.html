<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Property Quotation Calculator</title>
<style>
  :root{
    --bg:#f5f7fb;
    --card:#ffffff;
    --ink:#1f2a37;
    --muted:#6b7280;
    --line:#e5e7eb;
    --brand:#215eac;
    --brand-2:#0ea5e9;
    --good:#e8f7ec;
    --good-border:#b7e2c0;
    --info:#eef5ff;
    --info-border:#c8dcff;
    --pill:#f8fafc;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--ink);font:15px/1.4 -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Inter,Arial,sans-serif}
  .wrap{max-width:1120px;margin:20px auto;padding:0 16px}
  header{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px}
  header h1{font-size:22px;margin:0}
  .btn{appearance:none;border:0;background:var(--brand);color:#fff;padding:10px 14px;border-radius:10px;cursor:pointer}
  .btn.subtle{background:#e2e8f0;color:#111}
  .btn + .btn{margin-left:8px}
  .card{background:var(--card);border:1px solid var(--line);border-radius:16px;padding:18px;margin-bottom:14px;box-shadow:0 4px 12px rgba(15,23,42,.04)}
  .card h2{font-size:16px;margin:0 0 12px 0;color:var(--brand)}
  .grid-2{display:grid;grid-template-columns:1fr 1fr;gap:14px}
  .grid-3{display:grid;grid-template-columns:repeat(3,1fr);gap:14px}
  label{display:block;font-size:12px;color:var(--muted);margin-bottom:6px}
  input[type="text"], input[type="number"]{width:100%;padding:12px 14px;border:1px solid var(--line);border-radius:12px;background:var(--pill);outline:none}
  input::placeholder{color:#c2c7cf}
  .rowline{height:1px;background:var(--line);margin:12px 0}
  .radio-pill{display:flex;gap:12px;flex-wrap:wrap}
  .radio-pill label{display:flex;align-items:center;gap:8px;border:1px solid var(--line);padding:10px 14px;border-radius:999px;background:#fff;color:#0f172a;cursor:pointer}
  .radio-pill input{accent-color:var(--brand)}
  .summary-list{display:flex;flex-direction:column;gap:10px}
  .item{display:flex;align-items:center;gap:12px}
  .item .label{flex:0 0 56%;border:1px solid var(--line);background:#fff;border-radius:12px;padding:12px 14px}
  .item .value{flex:1;border:1px solid var(--line);background:#fff;border-radius:12px;padding:12px 14px;text-align:right;font-variant-numeric:tabular-nums}
  .item.info .label, .item.info .value{background:var(--info);border-color:var(--info-border);font-weight:600}
  .item.good .label, .item.good .value{background:var(--good);border-color:var(--good-border);font-weight:600}
  .muted{color:var(--muted)}
  .hint{font-size:12px;color:var(--muted)}
  @media (max-width: 768px){
    .grid-2, .grid-3{grid-template-columns:1fr}
    .item .label{flex:1}
  }
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Property Quotation Calculator</h1>
      <div>
        <button class="btn subtle" onclick="window.print()">Print / Save PDF</button>
        <button class="btn" onclick="compute()">Compute</button>
      </div>
    </header>

    <!-- Project Details -->
    <section class="card">
      <h2>Project Details</h2>
      <div class="grid-2">
        <div>
          <label>Project Name</label>
          <input id="projName" type="text" placeholder="e.g., South Residences">
        </div>
        <div>
          <label>Unit</label>
          <input id="unit" type="text" placeholder="e.g., B030916">
        </div>
        <div>
          <label>Unit Area (sqm)</label>
          <input id="area" type="text" placeholder="e.g., 36.53">
        </div>
        <div>
          <label>View</label>
          <input id="view" type="text" placeholder="e.g., Mall View">
        </div>
      </div>
    </section>

<!-- Pricing & Discounts -->
    <section class="card">
      <h2>Pricing & Discounts</h2>
      <div class="grid-2">
        <div>
          <label>List Price (₱)</label>
          <input id="listPrice" type="number" step="0.01" placeholder="">
        </div>
        <div>
          <label>Other Charges (₱)</label>
          <input id="otherCharges" type="number" step="0.01" placeholder="">
        </div>
        <div>
          <label>Standard Discount</label>
          <input id="disc1" type="text" placeholder="e.g. 21% or 100000">
        </div>
        <div>
          <label>Special Discount</label>
          <input id="disc2" type="text" placeholder="e.g. 5% or 50000">
        </div>
        <div>
          <label>Additional Discount</label>
          <input id="disc3" type="text" placeholder="e.g. 1% or 20000">
        </div>
        <div>
          <label>Rebate Discount</label>
          <input id="disc4" type="text" placeholder="e.g. 1.5% or 30000">
        </div>
        <div>
          <label>Reservation Fee (₱)</label>
          <input id="reservation" type="number" step="0.01" placeholder="">
        </div>
      </div>
    </section>

<!-- Payment Term -->
    <section class="card">
      <h2>Payment Term</h2>
      <div class="radio-pill">
        <label><input type="radio" name="pt" value="spread" checked> Spread DP</label>
        <label><input type="radio" name="pt" value="spot"> Spot Downpayment</label>
        <label><input type="radio" name="pt" value="split"> Split (with DP & Monthly)</label>
      </div>

      <div class="rowline"></div>

      <!-- Spread fields -->
      <div id="spreadFields" class="grid-3">
        <div>
          <label>DP % of TAP</label>
          <input id="dpPct_spread" type="number" step="0.01" placeholder="e.g., 5">
        </div>
        <div>
          <label>DP Equity % of TAP</label>
          <input id="dpEqPct_spread" type="number" step="0.01" placeholder="e.g., 5">
        </div>
        <div>
          <label>Equity Months</label>
          <input id="eqMonths_spread" type="number" step="1" placeholder="e.g., 12">
        </div>
      </div>

      <!-- Spot fields -->
      <div id="spotFields" class="grid-2" style="display:none;margin-top:6px">
        <div>
          <label>DP % of TAP</label>
          <input id="dpPct_spot" type="number" step="0.01" placeholder="e.g., 5">
        </div>
      </div>

      <!-- Split fields -->
      <div id="splitFields" class="grid-3" style="display:none;margin-top:6px">
        <div>
          <label>Spot % of TAP</label>
          <input id="spotPct_split" type="number" step="0.01" placeholder="e.g., 5">
        </div>
        <div>
          <label>Equity % of TAP</label>
          <input id="eqPct_split" type="number" step="0.01" placeholder="e.g., 5">
        </div>
        <div>
          <label>Equity Months</label>
          <input id="eqMonths_split" type="number" step="1" placeholder="e.g., 12">
        </div>
      </div>
      <p class="hint">Note: All DP/Equity percentages are taken from <b>TAP</b>.</p>
    </section>





    

    

    <!-- Bank & Agent -->
    <section class="card">
      <h2>Bank Financing</h2>
      <div class="grid-2">
        <div>
          <label>Interest Rate (annual, %)</label>
          <input id="interest" type="number" step="0.01" placeholder="e.g., 6.5">
        </div>
      </div>
    </section>

    <section class="card">
      <h2>Property Consultant</h2>
      <div class="grid-3">
        <div>
          <label>Name</label>
          <input id="agentName" type="text" placeholder="">
        </div>
        <div>
          <label>Contact Number</label>
          <input id="agentContact" type="text" placeholder="">
        </div>
        <div>
          <label>Position</label>
          <input id="agentPosition" type="text" placeholder="">
        </div>
      </div>
    </section>

    <!-- Summary -->
    <section class="card" id="summaryCard">
      <h2>Breakdown Summary</h2>
      <div class="summary-list" id="sum"></div>
    </section>
  </div>

<script>
  // Helpers
  const fmt = (v)=>{
    if(isNaN(v)) return "₱0.00";
    const s = Number(v).toFixed(2);
    return "₱"+s.replace(/\\B(?=(\\d{3})+(?!\\d))/g,",");
  }
  const toNum = (id)=>{
    const el = document.getElementById(id);
    if(!el) return 0;
    const v = parseFloat(el.value);
    return isNaN(v) ? 0 : v;
  }
  const parseDiscount = (raw, base)=>{
    if(!raw) return 0;
    raw = String(raw).trim();
    if(raw.endsWith('%')) return base * (parseFloat(raw)/100);
    const val = parseFloat(raw);
    return isNaN(val) ? 0 : val;
  }
  const addItem = (root, label, value, cls="")=>{
    const row = document.createElement('div');
    row.className = 'item'+(cls?(' '+cls):'');
    const l = document.createElement('div'); l.className='label'; l.textContent = label;
    const v = document.createElement('div'); v.className='value'; v.textContent = (typeof value==='number' ? fmt(value) : value);
    row.appendChild(l); row.appendChild(v); root.appendChild(row);
  }
  const line = (root)=>{
    const hr = document.createElement('div');
    hr.className='rowline'; root.appendChild(hr);
  }

  // Toggle payment term fields
  document.querySelectorAll('input[name="pt"]').forEach(r=>{
    r.addEventListener('change', (e)=>{
      const v = e.target.value;
      document.getElementById('spreadFields').style.display = v==='spread' ? 'grid' : 'none';
      document.getElementById('spotFields').style.display   = v==='spot'   ? 'grid' : 'none';
      document.getElementById('splitFields').style.display  = v==='split'  ? 'grid' : 'none';
      compute();
    });
  });

  // Compute
  function compute(){
    const root = document.getElementById('sum');
    root.innerHTML = '';

    // 1) Discounts (sequential on running base)
    const list = toNum('listPrice');
    addItem(root, 'List Price', list);

    let run = list;
    const d1 = parseDiscount(document.getElementById('disc1').value, run); run -= d1; addItem(root, 'Standard Discount', -d1);
    const d2 = parseDiscount(document.getElementById('disc2').value, run); run -= d2; addItem(root, 'Special Discount', -d2);
    const d3 = parseDiscount(document.getElementById('disc3').value, run); run -= d3; addItem(root, 'Additional Discount', -d3);
    const d4 = parseDiscount(document.getElementById('disc4').value, run); run -= d4; addItem(root, 'Rebate Discount', -d4);
    addItem(root, 'Net List Price', run, 'info');

    // 2) Charges + VAT
    const other = toNum('otherCharges'); addItem(root, 'Other Charges', other);
    let vat = 0, vatLabel = 'VAT (Exempt)';
    if(run > 3600000){ vat = run * 0.12; vatLabel = 'VAT'; }
    addItem(root, vatLabel, vat);

    line(root);

    // TAP
    const TAP = run + other + vat;
    

    // 3) Payment Term logic
    const res = toNum('reservation');
    const pt = document.querySelector('input[name="pt"]:checked').value;
    let loanable = TAP;

    if(pt==='spread'){
      const dpPct = toNum('dpPct_spread')/100;
      const eqPct = toNum('dpEqPct_spread')/100;
      const months = Math.max(1, parseInt(toNum('eqMonths_spread')));

      const DP = TAP * dpPct;
      addItem(root, `Downpayment (${(dpPct*100).toFixed(2)}% of TAP)`, DP);
      addItem(root, 'Reservation Fee', res);
      addItem(root, 'Net Downpayment', DP - res, 'info');

      line(root);

      const equity = TAP * eqPct;
      addItem(root, `Downpayment Equity (${(eqPct*100).toFixed(2)}% of TAP)`, equity);
      addItem(root, 'No. of Months', months);
      addItem(root, 'Monthly Equity Amortization', equity / months);

      loanable = TAP - (DP + equity);
      line(root);
      addItem(root, 'Remaining Balance', loanable, 'good');
    }

    if(pt==='spot'){
      const dpPct = toNum('dpPct_spot')/100;
      const DP = TAP * dpPct;
      addItem(root, `Downpayment (${(dpPct*100).toFixed(2)}% of TAP)`, DP);
      addItem(root, 'Reservation Fee', res);
      addItem(root, 'Net Downpayment', DP - res, 'info');

      loanable = TAP - DP;
      line(root);
      addItem(root, 'Remaining Balance', loanable, 'good');
    }

    if(pt==='split'){
      const spotPct = toNum('spotPct_split')/100;
      const eqPct   = toNum('eqPct_split')/100;
      const months  = Math.max(1, parseInt(toNum('eqMonths_split')));

      const spot = TAP * spotPct;
      addItem(root, `Spot Downpayment (${(spotPct*100).toFixed(2)}% of TAP)`, spot);
      addItem(root, 'Reservation Fee', res);
      addItem(root, 'Net Spot Downpayment', spot - res, 'info');

      line(root);

      const equity = TAP * eqPct;
      addItem(root, `Downpayment Equity (${(eqPct*100).toFixed(2)}% of TAP)`, equity);
      addItem(root, 'No. of Months', months);
      addItem(root, 'Monthly Equity Amortization', equity / months);

      loanable = TAP - (spot + equity);
      line(root);
      addItem(root, 'Remaining Balance', loanable, 'good');
    }

    line(root);
    addItem(root, 'Loanable Amount (Bank)', loanable, 'good');

    // 4) Bank amortization
    const annual = toNum('interest');
    const r = annual/100/12; // monthly
    const terms = [5,10,15,20];
    for(const y of terms){
      const n = y*12;
      const p = r===0 ? (loanable/n) : (loanable * (r * Math.pow(1+r,n)) / (Math.pow(1+r,n)-1));
      addItem(root, `${y} years (est. monthly)`, p);
    }

    line(root);
    addItem(root, 'Prepared by', document.getElementById('agentName').value || '—');
    addItem(root, 'Contact', document.getElementById('agentContact').value || '—');
    addItem(root, 'Position', document.getElementById('agentPosition').value || '—');
  }

  // Auto compute on input for quick preview
  document.addEventListener('input', (e)=>{
    // Recompute for any field change
    if(e.target.closest('.card')) compute();
  });
</script>
</body>
</html>
