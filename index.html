<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Property Quotation – Mobile Brochure</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

<style>
  :root{
    --bg:#f7f8fb;
    --ink:#0f172a;          /* slate-900 */
    --sub:#334155;          /* slate-700 */
    --muted:#64748b;        /* slate-500 */
    --brand:#194B79;        /* deep steel blue from your ref */
    --brand-2:#2563eb;
    --accent:#0ea5e9;
    --frost-bg: rgba(255,255,255,0.65);
    --frost-stroke: rgba(15,23,42,0.06);
    --card-shadow: 0 4px 20px rgba(2,6,23,0.06);
    --radius:16px;
    --gap:14px;
    --field-h:42px;
  }

  *{box-sizing:border-box}
  html,body{margin:0;background:var(--bg);color:var(--ink);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
  .wrap{max-width:940px;margin:20px auto 120px;padding:0 14px}

  /* HEADER */
  .hero{
    position:sticky; top:0; z-index:3;
    backdrop-filter: blur(10px);
    background:linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,255,255,0.55));
    border-bottom:1px solid var(--frost-stroke);
  }
  .hero-inner{max-width:940px;margin:0 auto;padding:14px}
  .title{
    display:flex;align-items:center;justify-content:space-between;gap:10px;
  }
  .title h1{font-size:18px;margin:0;font-weight:800;letter-spacing:.2px;color:var(--brand)}
  .tag{font-size:12px;color:var(--muted)}
  .pill{
    border:1px solid var(--frost-stroke);
    background:rgba(255,255,255,0.8);
    backdrop-filter: blur(6px);
    padding:8px 12px;border-radius:999px;
    font-size:12px;color:var(--sub);
  }

  /* CARDS */
  .card{
    background:var(--frost-bg);backdrop-filter: blur(12px);
    border:1px solid var(--frost-stroke);
    border-radius:var(--radius);
    box-shadow:var(--card-shadow);
    padding:16px;margin:10px 0;
  }
  .card h2{
    margin:0 0 10px;font-size:14px;letter-spacing:.3px;
    color:var(--brand);font-weight:800;text-transform:uppercase;
  }
  .grid-2{
    display:grid;grid-template-columns:1fr 1fr;gap:14px;
  }
  .grid-3{
    display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;
  }
  .row{display:flex;gap:10px;align-items:flex-end;flex-wrap:wrap}

  /* FIELDS */
  .field{display:flex;flex-direction:column;gap:6px}
  .field label{font-size:11px;color:var(--muted);font-weight:600}
  .input{
    height:var(--field-h);
    border:1px solid var(--frost-stroke);
    background:rgba(255,255,255,0.85);
    border-radius:12px;padding:0 12px;font-size:13px;color:var(--ink);
    outline:none;width:100%;
  }
  .input::placeholder{color:#94a3b8}
  .mini{height:36px}
  .ghost-note{font-size:11px;color:#94a3b8}

  /* PAYMENT OPTION TABS */
  .options{display:flex;gap:8px;flex-wrap:wrap;margin-top:6px}
  .opt{
    border:1px solid var(--frost-stroke);
    background:#ffffffc4;
    padding:8px 12px;border-radius:10px;font-size:12px;
    cursor:pointer;color:var(--sub);
    transition:all .2s ease;
  }
  .opt.active{background:var(--brand);color:#fff;border-color:transparent;box-shadow:0 6px 18px rgba(25,75,121,.25)}

  /* BUTTONS */
  .actions{display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-end;margin:14px 0}
  .btn{
    height:40px;border:none;border-radius:12px;padding:0 14px;
    font-weight:700;letter-spacing:.2px;cursor:pointer;
  }
  .btn-primary{background:var(--brand);color:#fff}
  .btn-outline{background:#fff;border:1px solid var(--frost-stroke);color:var(--sub)}
  .btn-danger{background:#ef4444;color:#fff}

  /* SUMMARY */
  .summary{display:none}
  .summary.show{display:block}
  .summary h3{
    margin:0 0 10px;font-size:15px;color:var(--brand);font-weight:800;text-transform:uppercase;
  }
  .summary-grid{
    display:grid;grid-template-columns:1fr;gap:10px;
  }
  .summary-card{
    border:1px dashed var(--frost-stroke);
    background:rgba(255,255,255,0.92);
    border-radius:14px;padding:12px;
  }
  .kv{display:grid;grid-template-columns:160px 1fr;gap:8px;align-items:center}
  .kv .k{color:var(--brand);font-weight:800}
  .kv .v{color:var(--ink);font-weight:600}
  .divider{height:1px;background:var(--frost-stroke);margin:8px 0}
  .muted{color:#94a3b8;font-size:12px}

  /* PROJECT DETAILS compact in summary */
  .pd-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px}
  .pd-item{display:flex;flex-direction:column}
  .pd-item .k{font-size:11px;color:var(--muted);font-weight:700}
  .pd-item .v{font-size:13px;color:var(--ink);font-weight:700}

  /* Responsive */
  @media (max-width: 760px){
    .grid-2{grid-template-columns:1fr}
    .kv{grid-template-columns:1fr}
    .pd-grid{grid-template-columns:1fr 1fr}
    .actions{justify-content:stretch}
    .btn{width:100%}
  }
</style>
</head>
<body>

<header class="hero">
  <div class="hero-inner">
    <div class="title">
      <h1>Property Quotation (Mobile Brochure)</h1>
      <span class="pill">Modern · Frosted · Compact</span>
    </div>
  </div>
</header>

<div class="wrap">

  <!-- 1) PROJECT DETAILS -->
  <section class="card" id="card-project">
    <h2>Project Details</h2>
    <div class="grid-2">
      <div class="field">
        <label>Project Name</label>
        <input id="projName" class="input" placeholder="e.g., South Residences" />
      </div>
      <div class="field">
        <label>Unit Type</label>
        <input id="unitType" class="input" placeholder="e.g., 1BR" />
      </div>

      <div class="field">
        <label>Floor Area (sqm)</label>
        <input id="floorArea" type="number" step="0.0001" class="input" placeholder="e.g., 36.53" />
      </div>
      <div class="field">
        <label>View</label>
        <input id="view" class="input" placeholder="e.g., Mall View" />
      </div>

      <div class="field">
        <label>Unit Code</label>
        <input id="unitCode" class="input" placeholder="e.g., B030916" />
      </div>
      <div class="field">
        <label>List Price</label>
        <input id="listPrice" type="number" step="0.01" class="input" placeholder="e.g., 5532000" />
      </div>
    </div>
  </section>

  <!-- 2) PRICING & DISCOUNTS (two columns, single box each; % or amount) -->
  <section class="card" id="card-pricing">
    <h2>Pricing & Discounts</h2>
    <div class="grid-2">
      <div class="field">
        <label>Standard Discount (enter % or amount)</label>
        <input id="discStandard" class="input" placeholder="e.g., 21% or 1160000" />
      </div>
      <div class="field">
        <label>Special Discount (enter % or amount)</label>
        <input id="discSpecial" class="input" placeholder="e.g., 5% or 200000" />
      </div>

      <div class="field">
        <label>Additional Discount (enter % or amount)</label>
        <input id="discAdditional" class="input" placeholder="e.g., 1% or 50000" />
      </div>
      <div class="field">
        <label>Rebate (enter % or amount)</label>
        <input id="discRebate" class="input" placeholder="e.g., 1.5% or 30000" />
      </div>
    </div>

    <div class="divider"></div>
    <div class="grid-2">
      <div class="field">
        <label>Other Charges (enter % or amount)</label>
        <input id="otherCharges" class="input" placeholder="e.g., 3% or 150000" />
      </div>
      <div class="field">
        <label>VAT Threshold (auto)</label>
        <input class="input" value="0% if NLP ≤ 3,600,000 · else 12%" disabled />
      </div>
    </div>
    <p class="ghost-note">Discounts are applied <b>successively</b> to the running base (List Price → after Std → after Special → after Additional → after Rebate). Other Charges and VAT are added after Net List Price.</p>
  </section>

  <!-- 3) PAYMENT TERM DETAILS -->
  <section class="card" id="card-terms">
    <h2>Payment Term Details</h2>

    <div class="options" id="termOptions">
      <button class="opt active" data-mode="spot">Spot DP (Cash)</button>
      <button class="opt" data-mode="split">Split (Spot + Equity)</button>
      <button class="opt" data-mode="spread">Spread DP (Preselling)</button>
    </div>

    <!-- Shared fields -->
    <div class="grid-2" style="margin-top:10px">
      <div class="field term-shared term-spot term-split">
        <label>Downpayment % (of TAP)</label>
        <input id="dpPercent" class="input" placeholder="e.g., 5%" />
      </div>
      <div class="field term-shared term-spot term-split">
        <label>Reservation Fee (amount)</label>
        <input id="reservationFee" type="number" step="0.01" class="input" placeholder="e.g., 20000" />
      </div>

      <!-- Equity for Split or Spread -->
      <div class="field term-split term-spread">
        <label>Downpayment (Equity) % (of TAP)</label>
        <input id="equityPercent" class="input" placeholder="e.g., 5%" />
      </div>
      <div class="field term-split term-spread">
        <label>No. of Months (Equity)</label>
        <input id="equityMonths" type="number" class="input" placeholder="e.g., 12" />
      </div>
    </div>

    <p class="ghost-note" id="modeNote">Mode: <b>Spot DP (Cash)</b> — DP = TAP × DP% · Net DP = DP − Reservation Fee · Remaining Balance = TAP − DP</p>
  </section>

  <!-- 4) INTEREST (BEFORE ACTIONS) -->
  <section class="card" id="card-interest">
    <h2>Bank Interest</h2>
    <div class="grid-2">
      <div class="field">
        <label>Annual Interest Rate (%)</label>
        <input id="interestRate" class="input" placeholder="e.g., 7.5" />
      </div>
      <div class="field">
        <label>Note</label>
        <input class="input" disabled value="Used for 5/10/15/20-year amortization in Summary" />
      </div>
    </div>
  </section>

  <!-- 5) ACTIONS (Compute & Save) -->
  <div class="actions">
    <button class="btn btn-outline" id="btnBack" style="display:none">Back / Edit</button>
    <button class="btn btn-danger" id="btnReset">Reset</button>
    <button class="btn btn-primary" id="btnCompute">Compute</button>
    <button class="btn btn-outline" id="btnPDF">Save as PDF</button>
  </div>

  <!-- 6) SUMMARY (only after Compute) -->
  <section class="card summary" id="summary">
    <h3>Property Quotation Summary</h3>

    <!-- Project Details (compact card above title area) -->
    <div class="summary-card">
      <div class="pd-grid">
        <div class="pd-item"><span class="k">Project</span><span class="v" id="sProj"></span></div>
        <div class="pd-item"><span class="k">Unit Type</span><span class="v" id="sType"></span></div>
        <div class="pd-item"><span class="k">Floor Area</span><span class="v" id="sArea"></span></div>
        <div class="pd-item"><span class="k">View</span><span class="v" id="sView"></span></div>
        <div class="pd-item"><span class="k">Unit</span><span class="v" id="sCode"></span></div>
      </div>
    </div>

    <!-- Pricing & Discounts -->
    <div class="summary-card">
      <div class="kv"><div class="k">List Price</div><div class="v" id="sList">—</div></div>
      <div class="kv"><div class="k" style="color:var(--brand)">Standard Discount</div><div class="v" id="sD1">—</div></div>
      <div class="kv"><div class="k" style="color:var(--brand)">Special Discount</div><div class="v" id="sD2">—</div></div>
      <div class="kv"><div class="k" style="color:var(--brand)">Additional Discount</div><div class="v" id="sD3">—</div></div>
      <div class="kv"><div class="k" style="color:var(--brand)">Rebate</div><div class="v" id="sD4">—</div></div>
      <div class="divider"></div>
      <div class="kv"><div class="k">Net List Price</div><div class="v" id="sNLP">—</div></div>
    </div>

    <!-- Other Charges & VAT -->
    <div class="summary-card">
      <div class="kv"><div class="k">Other Charges</div><div class="v" id="sOC">—</div></div>
      <div class="kv"><div class="k">VAT</div><div class="v" id="sVAT">—</div></div>
      <div class="divider"></div>
      <div class="kv"><div class="k" style="font-size:15px">TOTAL AMOUNT PAYABLE</div><div class="v" id="sTAP" style="font-size:15px">—</div></div>
    </div>

    <!-- Payment Term Details -->
    <div class="summary-card" id="summary-terms">
      <div class="kv"><div class="k">Downpayment</div><div class="v" id="sDP">—</div></div>
      <div class="kv"><div class="k" style="color:var(--brand)">Reservation Fee</div><div class="v" id="sRF">—</div></div>
      <div class="kv"><div class="k">Net Downpayment</div><div class="v" id="sNetDP">—</div></div>
      <div class="divider"></div>
      <div class="kv"><div class="k">Downpayment (Equity)</div><div class="v" id="sEquity">—</div></div>
      <div class="kv"><div class="k" style="color:var(--brand)">Monthly Amortization</div><div class="v" id="sEquityMonthly">—</div></div>
      <div class="kv"><div class="k">Remaining Balance</div><div class="v" id="sRemain">—</div></div>
    </div>

    <!-- Bank Financing -->
    <div class="summary-card">
      <div class="kv"><div class="k">Interest (annual)</div><div class="v" id="sRate">—</div></div>
      <div class="divider"></div>
      <div class="kv"><div class="k">5 yrs Est. Monthly</div><div class="v" id="sB5">—</div></div>
      <div class="kv"><div class="k">10 yrs Est. Monthly</div><div class="v" id="sB10">—</div></div>
      <div class="kv"><div class="k">15 yrs Est. Monthly</div><div class="v" id="sB15">—</div></div>
      <div class="kv"><div class="k">20 yrs Est. Monthly</div><div class="v" id="sB20">—</div></div>
    </div>

    <!-- Property Consultant -->
    <div class="summary-card">
      <div class="pd-grid">
        <div class="pd-item"><span class="k">Prepared by</span><span class="v" id="sAgentName">—</span></div>
        <div class="pd-item"><span class="k">Contact No.</span><span class="v" id="sAgentPhone">—</span></div>
        <div class="pd-item"><span class="k">Position</span><span class="v" id="sAgentPos">—</span></div>
      </div>
      <div class="muted" style="margin-top:6px"><em>This computation is for presentation purposes only and may change without prior notice.</em></div>
    </div>
  </section>

  <!-- 7) AGENT DETAILS (at the bottom while editing) -->
  <section class="card" id="card-agent">
    <h2>Property Consultant</h2>
    <div class="grid-2">
      <div class="field">
        <label>Name</label>
        <input id="agentName" class="input" placeholder="e.g., Juan Dela Cruz" />
      </div>
      <div class="field">
        <label>Contact No.</label>
        <input id="agentPhone" class="input" placeholder="e.g., +63 900 000 0000" />
      </div>
      <div class="field">
        <label>Position</label>
        <input id="agentPos" class="input" placeholder="e.g., Property Consultant" />
      </div>
    </div>
  </section>

</div>

<script>
(function(){
  const $ = (id)=>document.getElementById(id);
  const fmt = (n)=> isNaN(n)? '—' : new Intl.NumberFormat('en-PH',{style:'currency',currency:'PHP',maximumFractionDigits:2}).format(n);
  const parseNum = (v)=>{
    if(v===undefined || v===null) return 0;
    const s = String(v).trim();
    if(!s) return 0;
    if(s.includes('%')){
      return {type:'pct', value: parseFloat(s.replace('%',''))/100};
    }
    const num = parseFloat(s.replaceAll(',',''));
    if(isNaN(num)) return 0;
    return {type:'amt', value:num};
  };

  /* Payment Term mode switching */
  const optionButtons = Array.from(document.querySelectorAll('.opt'));
  const modeNote = $('modeNote');
  let termMode = 'spot';
  function setMode(m){
    termMode = m;
    optionButtons.forEach(b=>b.classList.toggle('active', b.dataset.mode===m));
    // hide/show fields
    const all = document.querySelectorAll('.term-shared, .term-spot, .term-split, .term-spread');
    all.forEach(el=>el.style.display='none');
    if(m==='spot'){
      document.querySelectorAll('.term-spot').forEach(el=>el.style.display='block');
      document.querySelectorAll('.term-shared').forEach(el=>el.style.display='block');
      modeNote.innerHTML = "Mode: <b>Spot DP (Cash)</b> — DP = TAP × DP% · Net DP = DP − Reservation Fee · Remaining Balance = TAP − DP";
    }else if(m==='split'){
      document.querySelectorAll('.term-split').forEach(el=>el.style.display='block');
      document.querySelectorAll('.term-shared').forEach(el=>el.style.display='block');
      modeNote.innerHTML = "Mode: <b>Split</b> — DP = TAP × DP% · Net DP = DP − Reservation Fee · Equity = TAP × Equity% · Monthly = Equity / months · Remaining = TAP − DP − Equity";
    }else{ // spread
      document.querySelectorAll('.term-spread').forEach(el=>el.style.display='block');
      modeNote.innerHTML = "Mode: <b>Spread DP (Preselling)</b> — Equity = TAP × Equity% · Monthly = Equity / months · Remaining = TAP − Equity";
    }
  }
  optionButtons.forEach(b=>b.addEventListener('click',()=>setMode(b.dataset.mode)));
  setMode('spot'); // default

  /* Reset */
  $('btnReset').addEventListener('click', ()=>{
    document.querySelectorAll('input.input:not([disabled])').forEach(i=>i.value='');
    setMode('spot');
    document.getElementById('summary').classList.remove('show');
    $('btnBack').style.display='none';
    window.scrollTo({top:0, behavior:'smooth'});
  });

  /* Back/Edit */
  $('btnBack').addEventListener('click', ()=>{
    document.getElementById('summary').classList.remove('show');
    $('btnBack').style.display='none';
    window.scrollTo({top:0, behavior:'smooth'});
  });

  /* Core compute */
  function computeAll(){
    // Inputs
    const LP = parseFloat($('listPrice').value||0);

    // Successive discounts
    let base = LP;
    function applyDisc(inputId){
      const p = parseNum($(inputId).value);
      if(!p || p.value===0) return 0;
      let d=0;
      if(p.type==='pct'){ d = base * p.value; }
      else { d = Math.min(p.value, base); }
      base -= d;
      return d;
    }
    const d1 = applyDisc('discStandard');
    const d2 = applyDisc('discSpecial');
    const d3 = applyDisc('discAdditional');
    const d4 = applyDisc('discRebate');
    const NLP = base; // net list price after successive

    // Other charges (after NLP)
    let oc=0;
    const ocp = parseNum($('otherCharges').value);
    if(ocp && ocp.value){
      if(ocp.type==='pct') oc = NLP * ocp.value;
      else oc = ocp.value;
    }

    // VAT rule (0 if NLP <= 3.6m else 12% of NLP)
    let vat = 0;
    if(NLP > 3600000){ vat = NLP * 0.12; }

    const TAP = NLP + oc + vat;

    // Payment terms
    // Defaults
    let dp=0, rf=parseFloat($('reservationFee').value||0), netdp=0, equity=0, eqMonths=0, eqMonthly=0, remain=0;

    const dpP = parseNum($('dpPercent').value);
    const eqP = parseNum($('equityPercent').value);
    eqMonths = parseInt(($('equityMonths').value||'0'), 10) || 0;

    if(termMode==='spot'){
      const pct = (dpP && dpP.type==='pct') ? dpP.value : 0;
      dp = TAP * pct;
      netdp = dp - rf;
      equity = 0;
      eqMonthly = 0;
      remain = TAP - dp;
    }else if(termMode==='split'){
      const pct = (dpP && dpP.type==='pct') ? dpP.value : 0;
      const epct = (eqP && eqP.type==='pct') ? eqP.value : 0;
      dp = TAP * pct;
      netdp = dp - rf;
      equity = TAP * epct;
      eqMonthly = eqMonths>0 ? (equity/eqMonths) : 0;
      remain = TAP - dp - equity;
    }else{ // spread
      const epct = (eqP && eqP.type==='pct') ? eqP.value : 0;
      dp = 0;
      netdp = 0 - rf; // show negative if they typed RF by mistake
      equity = TAP * epct;
      eqMonthly = eqMonths>0 ? (equity/eqMonths) : 0;
      remain = TAP - equity;
    }

    // Bank amortization estimates (use Remaining Balance as loanable amount)
    const r = parseFloat($('interestRate').value||0)/100;
    function bank(L, years){
      if(L<=0 || r<=0) return 0;
      const i = r/12, n = years*12;
      return L * ( i / (1-Math.pow(1+i,-n)) );
    }
    const b5 = bank(remain,5), b10 = bank(remain,10), b15 = bank(remain,15), b20 = bank(remain,20);

    // Fill summary
    $('sProj').textContent = $('projName').value || '—';
    $('sType').textContent = $('unitType').value || '—';
    $('sArea').textContent = ($('floorArea').value ? $('floorArea').value+' sqm' : '—');
    $('sView').textContent = $('view').value || '—';
    $('sCode').textContent = $('unitCode').value || '—';

    $('sList').textContent = fmt(LP);
    $('sD1').textContent = d1? ('– '+fmt(d1)) : '—';
    $('sD2').textContent = d2? ('– '+fmt(d2)) : '—';
    $('sD3').textContent = d3? ('– '+fmt(d3)) : '—';
    $('sD4').textContent = d4? ('– '+fmt(d4)) : '—';
    $('sNLP').textContent = fmt(NLP);

    $('sOC').textContent = fmt(oc);
    $('sVAT').textContent = fmt(vat);
    $('sTAP').textContent = fmt(TAP);

    $('sDP').textContent = dp? fmt(dp): '—';
    $('sRF').textContent = rf? fmt(rf): '—';
    $('sNetDP').textContent = (dp||rf)? fmt(netdp): '—';
    $('sEquity').textContent = equity? fmt(equity): '—';
    $('sEquityMonthly').textContent = eqMonthly? fmt(eqMonthly): '—';
    $('sRemain').textContent = fmt(remain);

    $('sRate').textContent = ($('interestRate').value? $('interestRate').value+'%':'—');
    $('sB5').textContent = b5? fmt(b5): '—';
    $('sB10').textContent = b10? fmt(b10): '—';
    $('sB15').textContent = b15? fmt(b15): '—';
    $('sB20').textContent = b20? fmt(b20): '—';

    // Agent
    $('sAgentName').textContent = $('agentName').value || '—';
    $('sAgentPhone').textContent = $('agentPhone').value || '—';
    $('sAgentPos').textContent = $('agentPos').value || '—';

    // Show summary only
    $('summary').classList.add('show');
    $('btnBack').style.display='inline-block';
    window.scrollTo({top: document.getElementById('summary').offsetTop - 20, behavior:'smooth'});
  }

  $('btnCompute').addEventListener('click', computeAll);

  // Save to PDF (print only summary view)
  $('btnPDF').addEventListener('click', ()=>{
    // Temporarily hide edit cards except summary
    const editCards = ['card-project','card-pricing','card-terms','card-interest','card-agent'];
    const hidden = [];
    editCards.forEach(id=>{
      const el = $(id);
      if(el){ hidden.push(el); el.style.display='none'; }
    });
    document.querySelector('.actions').style.display='none';
    $('summary').classList.add('show');

    window.print();

    // Restore
    hidden.forEach(el=>el.style.display='');
    document.querySelector('.actions').style.display='flex';
  });

})();
</script>

</body>
</html>
