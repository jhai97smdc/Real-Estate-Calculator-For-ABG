<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Property Quotation Calculator</title>
<style>
  :root{
    --bg:#f7f9fc;
    --card:#ffffff;
    --ink:#17223b;
    --muted:#62708a;
    --line:#e6ecf5;
    --accent:#2463eb;
    --accent-ink:#0f3fb5;
    --good:#0b8f4d;
  }
  *{box-sizing:border-box}
  html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);font:14px/1.45 "Inter", system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";}
  h1{font-size:20px;margin:0 0 12px 0}
  h2{font-size:16px;margin:0 0 12px 0;color:var(--accent)}
  .wrap{max-width:1200px;margin:24px auto;padding:0 16px}
  .grid{display:grid;grid-template-columns:1.2fr 1fr;gap:16px}
  .card{background:var(--card);border:1px solid var(--line);border-radius:14px;box-shadow:0 1px 0 rgba(0,0,0,.04);padding:16px}
  .subgrid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  .field{display:flex;flex-direction:column;gap:6px}
  .field label{font-size:12px;color:var(--muted);letter-spacing:.02em}
  .field input, .field select{
    padding:12px 12px;border:1px solid var(--line);border-radius:10px;background:#f9fafb;outline:none;
  }
  .field input:focus, .field select:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(36,99,235,.12);background:#fff}
  .row{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
  .radio-group{display:flex;gap:12px;flex-wrap:wrap}
  .radio{display:flex;align-items:center;gap:6px;border:1px solid var(--line);padding:8px 12px;border-radius:24px;background:#fff;cursor:pointer}
  .radio input{accent-color:var(--accent)}
  .muted{color:var(--muted)}
  .actions{display:flex;gap:8px;flex-wrap:wrap}
  button{
    border:1px solid var(--accent);background:var(--accent);color:#fff;border-radius:10px;padding:10px 14px;cursor:pointer;
  }
  button.ghost{background:#fff;color:var(--accent);}
  button:active{transform:translateY(1px)}
  table{width:100%;border-collapse:separate;border-spacing:0 8px}
  th,td{padding:10px 12px;vertical-align:top}
  th{color:var(--muted);font-weight:600;text-align:left;border-bottom:1px solid var(--line);}
  tr.data-row td{background:#fff;border:1px solid var(--line);border-left:4px solid transparent;border-radius:8px}
  tr.total td{background:#f0f5ff;border:1px solid #dbe6ff;border-left-color:var(--accent)}
  tr.highlight td{background:#f3fbf7;border:1px solid #cfefdf;border-left-color:var(--good)}
  .mono{font-variant-numeric:tabular-nums}
  .small{font-size:12px;color:var(--muted)}
  .section-title{margin:16px 0 8px 0;color:var(--accent)}
  .footer-note{margin-top:8px;font-size:12px;color:var(--muted)}
  .divider{height:1px;background:var(--line);margin:12px 0}
  @media (max-width:980px){ .grid{grid-template-columns:1fr} }

  /* Compact summary table for mobile screenshot */
  #summaryBody td, #summaryBody th {
    padding: 6px 8px;
    font-size: 13px;
  }
  #summaryBody tr.data-row td, 
  #summaryBody tr.total td, 
  #summaryBody tr.highlight td {
    border-radius:6px;
  }

  /* Center summary card on small screens */
  @media (max-width:768px){
    .grid { grid-template-columns:1fr; justify-items:center; }
    .grid .card { width:100%; max-width:500px; }
  }

</style>
</head>
<body>
  <div class="wrap">
    <h1>Property Quotation Calculator</h1>
    <div class="grid">
      <!-- LEFT: Inputs -->
      <div class="card">
        <h2>Inputs</h2>

        <div class="section-title">Project Details</div>
        <div class="subgrid">
          <div class="field"><label>Project Name</label><input id="projName" placeholder=""/></div>
          <div class="field"><label>Unit</label><input id="unit" placeholder="e.g. B030916"/></div>
          <div class="field"><label>Unit Area (sqm)</label><input id="area" type="number" step="0.01" placeholder="36.53"/></div>
          <div class="field"><label>View</label><input id="view" placeholder="e.g. Mall View"/></div>
        </div>

        <div class="divider"></div>

        <div class="section-title">Pricing & Discounts</div>
        <div class="subgrid">
          <div class="field"><label>List Price</label><input id="listPrice" type="number" step="0.01" value="5532000"/></div>
          <div class="field"><label>Standard Discount</label><input id="disc1" placeholder="e.g. 21% or 100000" value="21%"/></div>
          <div class="field"><label>Special Discount</label><input id="disc2" placeholder="e.g. 5% or 50000" value="5%"/></div>
          <div class="field"><label>Additional Discount</label><input id="disc3" placeholder="e.g. 1% or 20000" value="1%"/></div>
          <div class="field"><label>Rebate Discount</label><input id="disc4" placeholder="e.g. 1.5% or 30000" value="1.5%"/></div>
          <div class="field"><label>Other Charges (₱)</label><input id="otherCharges" type="number" step="0.01" value="0"/></div>
          <div class="field"><label>Reservation Fee (₱)</label><input id="reservation" type="number" step="0.01" value="50000"/></div>
        </div>

        <div class="divider"></div>

        <div class="section-title">Payment Term</div>
        <div class="row radio-group">
          <label class="radio"><input type="radio" name="payopt" value="spread" checked> <span>Spread DP</span></label>
          <label class="radio"><input type="radio" name="payopt" value="spot"> <span>Spot Downpayment</span></label>
          <label class="radio"><input type="radio" name="payopt" value="split"> <span>Split (with DP &amp; Monthly)</span></label>
        </div>

        <div id="spreadFields" class="subgrid" style="margin-top:8px;">
          <div class="field"><label>DP % (of TAP)</label><input id="dpPct_spread" type="number" step="0.01" value="10"/></div>
          <div class="field"><label>DP Equity % (of TAP)</label><input id="dpEqPct_spread" type="number" step="0.01" value="5"/></div>
          <div class="field"><label>Equity Months</label><input id="eqMonths_spread" type="number" step="1" value="18"/></div>
        </div>

        <div id="spotFields" class="subgrid" style="display:none;margin-top:8px;">
          <div class="field"><label>DP % (of TAP)</label><input id="dpPct_spot" type="number" step="0.01" value="10"/></div>
        </div>

        <div id="splitFields" class="subgrid" style="display:none;margin-top:8px;">
          <div class="field"><label>Spot % (of TAP)</label><input id="spotPct_split" type="number" step="0.01" value="5"/></div>
          <div class="field"><label>Equity % (of TAP)</label><input id="eqPct_split" type="number" step="0.01" value="5"/></div>
          <div class="field"><label>Equity Months</label><input id="eqMonths_split" type="number" step="1" value="18"/></div>
        </div>

        <div class="divider"></div>

        <div class="section-title">Bank Financing</div>
        <div class="subgrid">
          <div class="field"><label>Interest Rate (annual, %)</label><input id="interest" type="number" step="0.01" value="6.50"/></div>
        </div>

        <div class="divider"></div>

        <div class="section-title">Property Consultant</div>
        <div class="subgrid">
          <div class="field"><label>Name</label><input id="agentName" placeholder="Your name"/></div>
          <div class="field"><label>Contact Number</label><input id="agentContact" placeholder="0917-xxx-xxxx"/></div>
          <div class="field"><label>Position</label><input id="agentPosition" placeholder="Property Consultant"/></div>
        </div>

        <div class="actions" style="margin-top:14px">
          <button id="btnCompute">Compute</button>
          <button class="ghost" id="btnReset">Reset</button>
        </div>
        <div class="footer-note">All amounts are formatted as ₱ with comma separators and 2 decimals. VAT is auto-computed: Exempt if Net List Price ≤ ₱3,600,000; otherwise VAT is applied and shown as “VAT”.</div>
      </div>

      <!-- RIGHT: Summary -->
      <div class="card">
        <h2>Quotation Summary</h2>
        <table>
          <thead>
            <tr><th>Description</th><th class="mono">Amount</th></tr>
          </thead>
          <tbody id="summaryBody">
            <!-- dynamic rows -->
          </tbody>
        </table>
      </div>
    </div>
  </div>

<script>
// ---------- Utilities ----------
const peso = (v)=>{
  const n = isFinite(v)? Number(v): 0;
  return "₱" + n.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ",");
};
const toNum = (el)=> parseFloat(el.value||0) || 0;

// Parse discount: string can be "5%" or "20000"
function parseDiscount(raw, base){
  if(!raw) return 0;
  const s = String(raw).trim();
  if(!s) return 0;
  if(s.endsWith("%")){
    const pct = parseFloat(s.replace("%",""))/100;
    if(!isFinite(pct)) return 0;
    return base * pct; // successive (percentage of running base)
  }else{
    const amt = parseFloat(s.replace(/,/g,""));
    return isFinite(amt)? amt: 0;
  }
}

function addRow(tbody, label, amount, cls="data-row"){
  const tr = document.createElement("tr");
  tr.className = cls;
  const td1 = document.createElement("td"); td1.textContent = label;
  const td2 = document.createElement("td"); td2.className="mono"; td2.textContent = peso(amount);
  tr.appendChild(td1); tr.appendChild(td2); tbody.appendChild(tr);
}
function addDivider(tbody){ const tr=document.createElement("tr"); const td=document.createElement("td"); td.colSpan=2; td.innerHTML='<div class="divider"></div>'; tr.appendChild(td); tbody.appendChild(tr); }

// ---------- Payment Option Toggles ----------
function showFields(val){
  document.getElementById("spreadFields").style.display = (val==="spread")?"grid":"none";
  document.getElementById("spotFields").style.display   = (val==="spot")  ?"grid":"none";
  document.getElementById("splitFields").style.display  = (val==="split") ?"grid":"none";
}
document.querySelectorAll('input[name="payopt"]').forEach(r=>{
  r.addEventListener("change", e=> showFields(e.target.value));
});
showFields(document.querySelector('input[name="payopt"]:checked').value);

// ---------- Core Compute ----------
function compute(){
  const tbody = document.getElementById("summaryBody");
  tbody.innerHTML = "";

  // Project details (optional display)
  const projName = document.getElementById("projName").value.trim();
  const unit = document.getElementById("unit").value.trim();
  const area = document.getElementById("area").value.trim();
  const view = document.getElementById("view").value.trim();

  // 1) List Price & Discounts (hybrid)
  let listPrice = toNum(document.getElementById("listPrice"));
  let running = listPrice;
  addRow(tbody, "List Price", listPrice);

  const dInputs = [
    document.getElementById("disc1").value,
    document.getElementById("disc2").value,
    document.getElementById("disc3").value,
    document.getElementById("disc4").value
  ];
  const dLabels = ["Standard Discount","Special Discount","Additional Discount","Rebate Discount"];

  for(let i=0;i<dInputs.length;i++){
    const applied = parseDiscount(dInputs[i], running);
    if(applied>0){
      addRow(tbody, dLabels[i] + (String(dInputs[i]).trim().endsWith("%")? ` (${String(dInputs[i]).trim()})` : ""), -applied);
      running -= applied;
      if(running<0) running = 0;
    }else{
      addRow(tbody, dLabels[i], 0);
    }
  }
  addRow(tbody, "Net List Price", running, "total");

  // 2) Charges & VAT
  const otherCharges = toNum(document.getElementById("otherCharges"));
  addRow(tbody, "Other Charges", otherCharges);

  let vat = 0;
  let vatLabel = "VAT (Exempt)";
  if(running > 3600000){
    vat = running * 0.12;
    vatLabel = "VAT";
  }
  addRow(tbody, vatLabel, vat);
  addDivider(tbody);

  const TAP = running + otherCharges + vat;
  addRow(tbody, "Total Amount Payable (TAP)", TAP, "total");

  // 3) Payment Term Options
  const payopt = document.querySelector('input[name="payopt"]:checked').value;
  const reservation = toNum(document.getElementById("reservation"));

  let remainingBalance = TAP;
  let loanable = 0;

  if(payopt==="spread"){
    const dpPct = toNum(document.getElementById("dpPct_spread"))/100;
    const dpEqPct = toNum(document.getElementById("dpEqPct_spread"))/100;
    const months = Math.max(1, Math.floor(toNum(document.getElementById("eqMonths_spread"))));

    const DP = TAP * dpPct;
    addRow(tbody, `Downpayment (${(dpPct*100).toFixed(2)}%)`, DP);
    addRow(tbody, "Less Reservation Fee", -reservation);
    const netDP = DP - reservation;
    addRow(tbody, "Net Downpayment", netDP, "highlight");

    const dpEquity = TAP * dpEqPct;
    addRow(tbody, `DP Equity (${(dpEqPct*100).toFixed(2)}%)`, dpEquity);
    const monthlyEq = dpEquity / months;
    addRow(tbody, `Monthly Equity (${months} mos)`, monthlyEq);

    remainingBalance = TAP - (DP + dpEquity);
    if(remainingBalance<0) remainingBalance=0;
    addDivider(tbody);
    addRow(tbody, `Remaining Balance (${(100-(dpPct*100+dpEqPct*100)).toFixed(2)}%)`, remainingBalance, "total");
    loanable = remainingBalance;

  }else if(payopt==="spot"){
    const dpPct = toNum(document.getElementById("dpPct_spot"))/100;
    const DP = TAP * dpPct;
    addRow(tbody, `Downpayment (${(dpPct*100).toFixed(2)}%)`, DP);
    addRow(tbody, "Less Reservation Fee", -reservation);
    const netDP = DP - reservation;
    addRow(tbody, "Net Downpayment", netDP, "highlight");

    remainingBalance = TAP * (1 - dpPct);
    if(remainingBalance<0) remainingBalance=0;
    addDivider(tbody);
    addRow(tbody, `Remaining Balance (${(100 - dpPct*100).toFixed(2)}%)`, remainingBalance, "total");
    loanable = remainingBalance;

  }else if(payopt==="split"){
    const spotPct = toNum(document.getElementById("spotPct_split"))/100;
    const eqPct = toNum(document.getElementById("eqPct_split"))/100;
    const months = Math.max(1, Math.floor(toNum(document.getElementById("eqMonths_split"))));

    const spotDP = TAP * spotPct;
    addRow(tbody, `Spot DP (${(spotPct*100).toFixed(2)}%)`, spotDP);
    addRow(tbody, "Less Reservation Fee", -reservation);
    const netSpot = spotDP - reservation;
    addRow(tbody, "Net Spot DP", netSpot, "highlight");

    const equityDP = TAP * eqPct;
    addRow(tbody, `Equity DP (${(eqPct*100).toFixed(2)}%)`, equityDP);
    const monthlyEq = equityDP / months;
    addRow(tbody, `Monthly Equity (${months} mos)`, monthlyEq);

    const totalPct = spotPct + eqPct;
    remainingBalance = TAP * (1 - totalPct);
    if(remainingBalance<0) remainingBalance=0;
    addDivider(tbody);
    addRow(tbody, `Remaining Balance (${(100 - totalPct*100).toFixed(2)}%)`, remainingBalance, "total");
    loanable = remainingBalance;
  }

  // 4) Bank Financing (fixed terms, one editable interest)
  const ir = toNum(document.getElementById("interest"))/100/12; // monthly
  const years = [5,10,15,20];
  const pmt = (principal, rate, months)=>{
    const n = months;
    if(principal<=0) return 0;
    if(rate===0) return principal/n;
    const a = Math.pow(1+rate, n);
    return principal * (rate * a) / (a - 1);
  };

  addDivider(tbody);
  addRow(tbody, "Loanable Amount (Bank)", loanable, "highlight");
  years.forEach(y=>{
    const m = y*12;
    const pay = pmt(loanable, ir, m);
    addRow(tbody, `${y} years (est. monthly)`, pay);
  });

  // 5) Property Consultant footer
  addDivider(tbody);
  const agentLines = [];
  const agentName = document.getElementById("agentName").value.trim();
  const agentContact = document.getElementById("agentContact").value.trim();
  const agentPosition = document.getElementById("agentPosition").value.trim();
  agentLines.push(agentName ? `Prepared by: ${agentName}` : "Prepared by: ");
  agentLines.push(agentContact ? `Contact: ${agentContact}` : "Contact: ");
  agentLines.push(agentPosition ? `Position: ${agentPosition}` : "Position: ");
  const tr = document.createElement("tr"); tr.className="data-row";
  const td1 = document.createElement("td"); td1.innerHTML = agentLines.join("<br>");
  const td2 = document.createElement("td"); td2.className="mono"; td2.innerHTML="&nbsp;";
  tr.appendChild(td1); tr.appendChild(td2); tbody.appendChild(tr);
}

// Buttons
document.getElementById("btnCompute").addEventListener("click", compute);
document.getElementById("btnReset").addEventListener("click", ()=> window.location.reload());

// Auto compute on load
compute();
</script>
</body>
</html>
